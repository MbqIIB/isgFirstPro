<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:beans="http://www.springframework.org/schema/beans" 
xsi:schemaLocation="
http://www.springframework.org/schema/beans 
http://www.springframework.org/schema/beans/spring-beans.xsd 
http://www.springframework.org/schema/security
http://www.springframework.org/schema/security/spring-security-3.1.xsd">


	<global-method-security pre-post-annotations="enabled" />
	
	
	<http auto-config="true" use-expressions="true" >
	    <!-- enable HTTPS 
	    <intercept-url pattern="/login" access="permitAll" requires-channel="https"/>
	    <intercept-url pattern="/loginfailed" access="permitAll" requires-channel="https"/>
	    <intercept-url pattern="/accessDenied" access="permitAll" requires-channel="https" />
	    -->
	    
	    <intercept-url pattern="/login" access="permitAll" />
	    <intercept-url pattern="/loginfailed" access="permitAll" />
	    <intercept-url pattern="/accessDenied" access="permitAll" />
	    
		<!-- <intercept-url pattern="/*" access="hasRole('ROLE_USER')"/>  -->
		<intercept-url pattern="/**" access="hasRole('ROLE_ADMIN')"/>
		<!-- <form-login login-page="/login"  />  -->
		
		<!-- <form-login always-use-default-target='false' login-processing-url="/login" default-target-url="/" authentication-failure-url="/" />  -->
		
		<form-login  login-page="/login" default-target-url="/welcome" authentication-failure-url="/loginfailed" always-use-default-target="true" />
		
		<!-- default logout -->
		<!-- <logout invalidate-session="true" logout-success-url="/" logout-url="/j_spring_security_logout"/>  -->
		
		<!-- custom logout -->
		<logout invalidate-session="true" logout-success-url="/login" logout-url="/j_spring_security_logout"/>
		
		<!-- <remember-me key="travelmanager" token-validity-seconds="3600" data-source-ref="dataSource"/>  -->
		
		<remember-me key="travelmanager" token-validity-seconds="3600" data-source-ref="dataSource"/>
		
		<access-denied-handler ref="accessDeniedHandler" />
		<!-- <port-mappings></port-mappings>  -->
		<!--  <session-management session-fixation-protection="none" />  -->
	</http>
	
	
	
	<authentication-manager alias="authenticationManager">
		<authentication-provider user-service-ref="jdbcUserService">
			<!-- 
			<user-service>
				<user authorities="ROLE_ADMIN" name="admin" password="admin"/>
			</user-service>
			 -->
			 <password-encoder ref="passwordEncoder" >
			 	<salt-source ref="saltSource" />
			 </password-encoder>
			 
			 <!-- 
			 <jdbc-user-service data-source-ref="dataSource" 
			 
			 users-by-username-query=" select username,password,enabled from tm_users where username=? " 
			 
			 authorities-by-username-query=" select u.username, ur.authority from tm_users u, tm_user_roles ur 
		        where u.user_id = ur.user_id and u.username =?  " 	
			 />
			  -->
			
			
			
			
		</authentication-provider>
		
	</authentication-manager>	
	
	
		
		
</beans:beans>